import{_ as y,o as u,c as m,a as x,u as S,r as l,b as j,d as a,n as g,m as M,v as P,k as _,j as U,g as h,t as F,p as J,h as N}from"./index-DwMKBNgu.js";import{a as V,c as Y,n as $}from"./index-C646Hu6T.js";const R={},T={class:"loader"},B=x('<div class="bar1" data-v-7d1c0d64></div><div class="bar2" data-v-7d1c0d64></div><div class="bar3" data-v-7d1c0d64></div><div class="bar4" data-v-7d1c0d64></div><div class="bar5" data-v-7d1c0d64></div><div class="bar6" data-v-7d1c0d64></div><div class="bar7" data-v-7d1c0d64></div><div class="bar8" data-v-7d1c0d64></div><div class="bar9" data-v-7d1c0d64></div><div class="bar10" data-v-7d1c0d64></div><div class="bar11" data-v-7d1c0d64></div><div class="bar12" data-v-7d1c0d64></div>',12),L=[B];function O(c,d){return u(),m("div",T,L)}const X=y(R,[["render",O],["__scopeId","data-v-7d1c0d64"]]),f=c=>(J("data-v-4c07f102"),c=c(),N(),c),z={id:"create-post-modal"},D=f(()=>a("h2",{class:"title"},"Create a Post",-1)),E=f(()=>a("label",{for:"message",class:"block mb-2 text-sm font-medium text-white"},null,-1)),W={for:"pi-c"},Z=f(()=>a("span",null,"Upload Image",-1)),q={class:"sbutton",type:"submit",name:"submit"},G={key:0,class:"text-red-500"},A={__name:"CreatePost",emits:["close"],setup(c){const d=S(),r=l(""),i=l(null),p=l(!1),b=l(null),s=l(null),v=l("");j(()=>{b.value=V("https://jzydvbxwyynlezjnqbbd.supabase.co/","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp6eWR2Ynh3eXlubGV6am5xYmJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjUwNDY3MjEsImV4cCI6MjA0MDYyMjcyMX0.kY7-gqw6RK42QZZ46WrNw9YLD3qmK9Ct9G-9NuHuW8w")});async function I(o){console.log("uploading file");const e=await Y(o);console.log(`usernamr: ${d.user.username}`);const{data:t,error:n}=await b.value.storage.from("ItterMedia").upload("/",""+$(),e);n?(console.error("Error uploading file:",n),n.value=n):(console.log("File uploaded successfully:",t),v.value=await this.supabase.storage.from("profilepics").getPublicUrl(t.path).data.publicUrl,console.log("Public URL:",v.value))}async function k(){p.value=!0,d.setCsrfToken(),s.value!==null?await I(s.value):console.log("no file selected");const e=await(await fetch("https://itter.pythonanywhere.com/api/create/post",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":d.csrfToken},body:JSON.stringify({content:r.value,media_url:v.value})})).json();e.error?(console.log(e.error),i.value=e.error):(console.log("success"),i.value=null,r.value=""),p.value=!1}async function w(o){s.value=o.target.files[0];var e=null;if(s.value){if(!s.value.type.startsWith("image/")){i.value="Please select a Proper image.",s.value=null;return}e=URL.createObjectURL(this.selectedFile)}else e=null;console.log(`file: ${s.value}
link: ${e}`)}function C(){document.getElementById("pi-c").click()}return(o,e)=>(u(),m("div",z,[a("div",{class:"create-post-background",onClick:e[3]||(e[3]=t=>o.$emit("close"))},[a("div",{class:"create-post",onClick:e[2]||(e[2]=g(()=>{},["stop"]))},[D,a("form",{onSubmit:g(k,["prevent"])},[E,M(a("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),placeholder:"What's on your mind?",class:"block p-2.5 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",rows:"5",required:""},null,512),[[P,r.value]]),a("label",W,[a("i",{class:"fa fa-cloud-upload",onClick:C}),_(),Z,a("input",{style:{padding:"0px"},onChange:e[1]||(e[1]=t=>w(t)),placeholder:"profile_image",id:"pi-c",type:"file",name:"profile_image",accept:"image/*",class:"textInput",capture:""},null,32)]),a("button",q,[p.value?(u(),U(X,{key:0})):h("",!0),_(" Post ")])],32),i.value?(u(),m("p",G,F(i.value),1)):h("",!0)])])]))}},H=y(A,[["__scopeId","data-v-4c07f102"]]);export{H as default};
