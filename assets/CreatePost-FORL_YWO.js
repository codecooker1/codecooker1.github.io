import{_ as k,o as u,f as m,x as P,u as S,j as l,l as $,a,q as b,m as T,v as U,d as h,c as j,n as y,t as F,p as M,e as B,k as N}from"./index-Ca9V9eaO.js";import{c as O,a as V,n as L}from"./index-CwvXjyEV.js";const R={},E={class:"loader"},q=P('<div class="bar1" data-v-18a93388></div><div class="bar2" data-v-18a93388></div><div class="bar3" data-v-18a93388></div><div class="bar4" data-v-18a93388></div><div class="bar5" data-v-18a93388></div><div class="bar6" data-v-18a93388></div><div class="bar7" data-v-18a93388></div><div class="bar8" data-v-18a93388></div><div class="bar9" data-v-18a93388></div><div class="bar10" data-v-18a93388></div><div class="bar11" data-v-18a93388></div><div class="bar12" data-v-18a93388></div>',12),D=[q];function W(n,_){return u(),m("div",E,D)}const z=k(R,[["render",W],["__scopeId","data-v-18a93388"]]),g=n=>(M("data-v-3111c000"),n=n(),B(),n),A={id:"create-post-modal"},J=g(()=>a("h2",{class:"title"},"Create a Post",-1)),X=g(()=>a("label",{for:"message",class:"block mb-2 text-sm font-medium text-white"},null,-1)),G={for:"pi-c"},H=g(()=>a("span",null,"Upload Image",-1)),K={class:"sbutton",type:"submit",name:"submit"},Q={key:0,class:"text-red-500"},Y={__name:"CreatePost",emits:["close"],setup(n){const _=N("hostname"),i=S(),c=l(""),r=l(null),v=l(!1),p=l(null),t=l(null),f=l("");$(()=>{p.value=O(void 0,void 0)});async function w(o){console.log("uploading file");const e=await V(o);console.log(`file: ${e}`),console.log(`usernamr: ${i.user.username}`);const{data:s,error:d}=await p.value.storage.from("ItterMedia").upload(`/${i.user.username}/${L()}.webp`,e,{contentType:"image/webp"});d?(console.error("Error uploading file:",d),d.value=d):(console.log("File uploaded successfully:",s),f.value=await p.value.storage.from("ItterMedia").getPublicUrl(s.path).data.publicUrl,console.log("Public URL:",f.value))}async function C(){v.value=!0,i.setCsrfToken(),t.value!==null?await w(t.value):console.log("no file selected");const e=await(await fetch(`${_}/api/create/post`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":i.csrfToken},body:JSON.stringify({content:c.value,media_url:f.value})})).json();e.error?(console.log(e.error),r.value=e.error):(console.log("success"),r.value=null,c.value=""),v.value=!1}async function x(o){t.value=o.target.files[0];var e=null;if(t.value){if(!t.value.type.startsWith("image/")){r.value="Please select a Proper image.",t.value=null;return}e=URL.createObjectURL(t.value)}else e=null;console.log(`file: ${t.value}
link: ${e}`)}function I(){document.getElementById("pi-c").click()}return(o,e)=>(u(),m("div",A,[a("div",{class:"create-post-background",onClick:e[3]||(e[3]=s=>o.$emit("close"))},[a("div",{class:"create-post",onClick:e[2]||(e[2]=b(()=>{},["stop"]))},[J,a("form",{onSubmit:b(C,["prevent"])},[X,T(a("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),placeholder:"What's on your mind?",class:"block p-2.5 w-full text-sm rounded-lg border bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500",rows:"5",required:""},null,512),[[U,c.value]]),a("label",G,[a("i",{class:"fa fa-cloud-upload",onClick:I}),h(),H,a("input",{style:{padding:"0px"},onChange:e[1]||(e[1]=s=>x(s)),placeholder:"profile_image",id:"pi-c",type:"file",name:"profile_image",accept:"image/*",class:"textInput",capture:""},null,32)]),a("button",K,[v.value?(u(),j(z,{key:0})):y("",!0),h(" Post ")])],32),r.value?(u(),m("p",Q,F(r.value),1)):y("",!0)])])]))}},Z=k(Y,[["__scopeId","data-v-3111c000"]]),te=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));export{Z as C,z as I,te as a};
