import{_ as g,k as _,u as b,f as c,a as e,q as x,m as a,v as l,t as m,c as y,n as h,d as I,o as n,p as w,e as U,r as v}from"./index-Bt9G2CkG.js";import{c as F,a as S,n as k}from"./index-OLH_AIxi.js";const R={data(){return{firstname:"",lastname:"",username:"",email:"",password:"",bio:"",profile_image:"",error:"",success:"",selectedFile:null,supabase:null,uploadError:"",authStore:"",isRegistering:!1,hostname:_("hostname")}},mounted(){this.supabase=F(void 0,void 0),this.authStore=b(),this.authStore.setCsrfToken()},methods:{async uploadFile(o){const s=await S(o),{data:p,error:u}=await this.supabase.storage.from("profilepics").upload("/"+k(),s,{contentType:s.type});u?console.error("Error uploading file:",u):(console.log("File uploaded successfully:",p),this.profile_image=await this.supabase.storage.from("profilepics").getPublicUrl(p.path).data.publicUrl,console.log("Public URL:",this.profile_image))},async register(){try{this.isRegistering=!0,await this.uploadFile(this.selectedFile),console.log(this.authStore.csrfToken);const o=await fetch(`${this.hostname}/api/create-user/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.authStore.csrfToken},body:JSON.stringify({firstname:this.firstname,lastname:this.lastname,email:this.email,password:this.password,bio:this.bio,username:this.username,profile_image:this.profile_image}),credentials:"include"}),s=await o.json();o.ok?this.success="Registration successful! Please Check your email for verification link to continue.":this.error=s.error||"Registration failed",this.isRegistering=!1}catch(o){this.error="An error occurred during registration: "+o}},async handleFileUpload(o){if(this.selectedFile=o.target.files[0],console.log(this.selectedFile),this.uploadError=null,this.uploadSuccess=null,this.selectedFile){if(!this.selectedFile.type.startsWith("image/")){this.uploadError="Please select a Proper image.",this.selectedFile=null,this.imageUrl=null;return}this.imageUrl=URL.createObjectURL(this.selectedFile)}else this.imageUrl=null}}},r=o=>(w("data-v-e92447c4"),o=o(),U(),o),T={class:"form-holder"},V={class:"form-box"},P=r(()=>e("span",{class:"title"},"Register",-1)),q={class:"textInputWrapper"},C=r(()=>e("label",{for:"firstname"},"First Name",-1)),E={class:"textInputWrapper"},W=r(()=>e("label",{for:"lastname"},"Last Name",-1)),L={class:"textInputWrapper"},N=r(()=>e("label",{for:"username"},"Username",-1)),j={class:"textInputWrapper"},B=r(()=>e("label",{for:"email"},"E-mail",-1)),O={class:"textInputWrapper"},A=r(()=>e("label",{for:"password"},"Password",-1)),D={class:"textInputWrapper"},M=r(()=>e("label",{for:"bio"},"Tell something about yourself",-1)),J={class:"textInputWrapper"},X=r(()=>e("label",{for:"pi"},"Profile Image",-1)),z={class:"sbutton",type:"submit",name:"submit"},G={key:0,class:"text-red-500"},H={key:1,class:"text-green-300"};function K(o,s,p,u,t,d){const f=v("IconLoading");return n(),c("div",T,[e("div",V,[P,e("form",{onSubmit:s[7]||(s[7]=x((...i)=>d.register&&d.register(...i),["prevent"])),class:"form"},[e("div",q,[C,a(e("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>t.firstname=i),placeholder:"First Name",type:"text",id:"firstname",name:"firstname",class:"textInput",required:""},null,512),[[l,t.firstname]])]),e("div",E,[W,a(e("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>t.lastname=i),placeholder:"Last name",type:"text",id:"lastname",name:"lastname",class:"textInput",required:""},null,512),[[l,t.lastname]])]),e("div",L,[N,a(e("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>t.username=i),placeholder:"Username",id:"username",type:"text",name:"username",class:"textInput",required:""},null,512),[[l,t.username]])]),e("div",j,[B,a(e("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>t.email=i),placeholder:"E-mail",type:"email",id:"email",name:"email",class:"textInput",required:""},null,512),[[l,t.email]])]),e("div",O,[A,a(e("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>t.password=i),placeholder:"Password",id:"password",type:"password",name:"password",class:"textInput",required:""},null,512),[[l,t.password]])]),e("div",D,[M,a(e("input",{"onUpdate:modelValue":s[5]||(s[5]=i=>t.bio=i),placeholder:"Tell about yourself",id:"bio",type:"textbox",name:"bio",class:"textInput",required:""},null,512),[[l,t.bio]])]),e("div",J,[X,e("input",{style:{padding:"0px"},onChange:s[6]||(s[6]=i=>d.handleFileUpload(i)),placeholder:"profile_image",id:"pi",type:"file",name:"profile_image",accept:"image/*",class:"textInput",required:"",capture:""},null,32),e("p",null,m(t.uploadError),1)]),e("button",z,[t.isRegistering?(n(),y(f,{key:0})):h("",!0),I(" Register ")])],32),t.error?(n(),c("p",G,m(t.error),1)):h("",!0),t.success?(n(),c("p",H,m(t.success),1)):h("",!0)])])}const Z=g(R,[["render",K],["__scopeId","data-v-e92447c4"]]);export{Z as default};
